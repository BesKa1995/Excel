/*! For license information please see bundle.d9a42a84b3439a9fcf06.js.LICENSE.txt */
(function(){"use strict";var __webpack_modules__={201:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function parse(){var value=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{if(value.startsWith("="))return eval(value.slice(1))}catch(t){return value}return value}__webpack_require__.d(__webpack_exports__,{Q:function(){return parse}})}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=function(t,e){for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var __webpack_exports__={};!function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var e=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"path",get:function(){return location.hash.slice(1)}},{key:"param",get:function(){return e.path.split("/")[1]}},{key:"navigate",value:function(t){location.hash=t}}],null&&t(n.prototype,null),r&&t(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){if(t>e){var n=[e,t];t=n[0],e=n[1]}return new Array(e-t+1).fill("").map((function(e,n){return t+n}))}function o(t){return{get:function(){return JSON.parse(localStorage.getItem(t))},set:function(e){localStorage.setItem(t,JSON.stringify(e))},remove:function(t){localStorage.removeItem(t)}}}function i(t,e){return"object"===n(t)&&"object"===n(e)?JSON.stringify(t)===JSON.stringify(e):t===e}function c(t){return t.replace(/([A-Z])/g,(function(t){return"-".concat(t[0].toLowerCase())}))}function a(t,e){var n;return function(){for(var r=this,o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];clearTimeout(n),n=setTimeout((function(){t.apply(r,i)}),e)}}function u(t){return JSON.parse(JSON.stringify(t))}function l(t){t.preventDefault()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$el="string"==typeof e?document.querySelector(e):e}var e,n;return e=t,n=[{key:"html",value:function(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.innerHTML.trim()}},{key:"clear",value:function(){return this.html(""),this}},{key:"append",value:function(t){var e=t.$el;return this.$el.appendChild(e),this}},{key:"attr",value:function(t,e){return e?e?(this.$el.setAttribute(t,e),this):this.$el.getAttribute(t):(this.$el.setAttribute(t,e),this)}},{key:"text",value:function(t){return void 0!==t?(this.$el.textContent=t,this):"input"===this.$el.tagName.toLowerCase()?this.$el.value.trim():this.$el.textContent.trim()}},{key:"on",value:function(t,e){this.$el.addEventListener(t,e)}},{key:"off",value:function(t,e){this.$el.removeEventListener(t,e)}},{key:"closest",value:function(t){return y(this.$el.closest(t))}},{key:"getCoords",value:function(){return this.$el.getBoundingClientRect()}},{key:"getStyles",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,n){return e[n]=t.$el.style[n],e}),{})}},{key:"data",get:function(){return this.$el.dataset}},{key:"find",value:function(t){return y(this.$el.querySelector(t))}},{key:"focus",value:function(){return this.$el.focus(),this}},{key:"addClass",value:function(t){return this.$el.classList.add(t),this}},{key:"removeClass",value:function(t){return this.$el.classList.remove(t),this}},{key:"findAll",value:function(t){return(e=this.$el.querySelectorAll(t),function(t){if(Array.isArray(t))return f(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(t){return y(t)}));var e}},{key:"id",value:function(t){if(t){var e=this.id().split(":");return{row:Number(e[0]),col:Number(e[1])}}return this.data.id}},{key:"css",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(e).forEach((function(n){t.$el.style[n]=e[n]}))}}],n&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t){return new p(t)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}y.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=document.createElement(t);return e&&n.classList.add(e),y(n)};var b=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t){if(!t||"string"!=typeof t)throw new Error("Selector is not provided in the Router")}(e),this.routes=n,this.$placeholder=y(e),this.changePageHandler=this.changePageHandler.bind(this),this.page=null,this.init()}var n,r;return n=t,r=[{key:"init",value:function(){window.addEventListener("hashchange",this.changePageHandler),this.changePageHandler()}},{key:"changePageHandler",value:function(){this.page&&this.page.destroy(),this.$placeholder.clear();var t=e.path.includes("excel")?this.routes.excel:this.routes.dashboard;this.page=new t(e.param),this.$placeholder.append(this.page.getRoot()),this.page.afterRender()}},{key:"destroy",value:function(){window.removeEventListener("hashchange",this.changePageHandler)}}],r&&h(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.params=e}var e,n;return e=t,(n=[{key:"getRoot",value:function(){throw new Error('Method "getRoot" should be implemented in '.concat(this.constructor.name))}},{key:"afterRender",value:function(){}},{key:"destroy",value:function(){}}])&&v(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function m(t){var e=o(t).get(),n=t.split(":")[1];return'\n         <li class="db__record">\n            <a href="#excel/'.concat(n,'">').concat(e.title,"</a>\n            <strong>\n                ").concat(new Date(e.openedDate).toLocaleDateString(),"\n                ").concat(new Date(e.openedDate).toLocaleTimeString(),"\n            </strong>\n        </li>\n    ")}function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}function _(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function P(t){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},P(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}(c,t);var e,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=P(r);if(o){var n=P(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return _(this,t)});function c(){return w(this,c),i.apply(this,arguments)}return e=c,(n=[{key:"getRoot",value:function(){var t,e=(new Date).getTime().toString();return y.create("div","db").html('\n        <div class="db__header">\n            <h1>Excel Dashboard</h1>\n        </div>\n        b\n        <div class="db__new">\n            <div class="db__view">\n                <a href="#excel/'.concat(e,'" class="db__create">\n                New <br /> Table\n                </a>\n            </div>\n        </div>\n  \n        <div class="db__table db__view">\n             ').concat((t=function(){for(var t=[],e=0;e<localStorage.length;e++){var n=localStorage.key(e);n.includes("excel")&&t.push(n)}return t}()).length?'\n        <div class="db__list-header">\n            <span>Title</span>\n            <span>Opening time</span>\n        </div>\n        <ul class="db__list">\n        '.concat(t.map(m).join(""),"\n        </ul>"):"<p>You have not created any tables yet</p>","\n             \n        </div>\n        "))}}])&&O(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(d);function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var E=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners={}}var e,n;return e=t,n=[{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.listeners[t].forEach((function(t){t.apply(void 0,n)})),!0}},{key:"subscribe",value:function(t,e){var n=this;return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),function(){n.listeners[t]=n.listeners[t].filter((function(t){return t!==e}))}}}],n&&k(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var T=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store=e,this.sub=null,this.prevState={}}var e,n;return e=t,n=[{key:"subscribeComponents",value:function(t){var e=this;this.prevState=this.store.getState(),this.sub=this.store.subscribe((function(n){Object.keys(n).forEach((function(r){i(e.prevState[r],n[r])||t.forEach((function(t){if(t.isWatching(r)){var e=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},r,n[r]);t.storeChanged(e)}}))})),e.prevState=e.store.getState()}))}},{key:"unsubscribeFromStore",value:function(){this.sub.unsubscribe()}}],n&&x(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),D="TABLE_RESIZE",R="CHANGE_TEXT",$="APPLY_STYLES",L="CHANGE_STYLES",C="CHANGE_TITLE",A="UPDATE_DATE";function N(t){return{type:D,data:t}}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var M=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.components=e.components||[],this.store=e.store,this.emitter=new E,this.subscriber=new T(this.store)}var e,n;return e=t,(n=[{key:"getRoot",value:function(){var t=this,e=y.create("div","excel");return this.components=this.components.map((function(n){var r=y.create("div",n.className),o=new n(r,{emitter:t.emitter,store:t.store});return r.html(o.toHTML()),e.append(r),o})),e.$el}},{key:"init",value:function(){document.addEventListener("contextmenu",l),this.store.dispatch({type:A}),this.subscriber.subscribeComponents(this.components),this.components.forEach((function(t){return t.init()}))}},{key:"destroy",value:function(){this.subscriber.unsubscribeFromStore(),this.components.forEach((function(t){return t.destroy()}))}}])&&I(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function B(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var z=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(B(this,t),!e)throw new Error("No $root provided for DomListener");this.$root=e,this.listeners=n}var e,n;return e=t,(n=[{key:"initDOMListeners",value:function(){var t=this;this.listeners.forEach((function(e){var n=G(e);if(!t[n])throw new Error("Method '".concat(n,"' does not exist in ").concat(t.name," Component"));t[n]=t[n].bind(t),t.$root.on(e,t[n])}))}},{key:"removeDOMListeners",value:function(){var t=this;this.listeners.forEach((function(e){var n=G(e);t.$root.off(e,t[n])}))}}])&&H(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function G(t){return"on"+((e=t).charAt(0).toUpperCase()+e.slice(1));var e}function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function J(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function W(t,e){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},W(t,e)}function Y(t,e){if(e&&("object"===q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function K(t){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},K(t)}var U=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&W(t,e)}(c,t);var e,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=K(r);if(o){var n=K(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Y(this,t)});function c(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return J(this,c),(e=i.call(this,t,n.listeners)).name=n.name||"",e.emitter=n.emitter,e.unsubscribers=[],e.prepare(),e.store=n.store,e.subscribe=n.subscribe||[],e}return e=c,n=[{key:"prepare",value:function(){}},{key:"toHTML",value:function(){return"test"}},{key:"$emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.emitter).emit.apply(e,[[t]].concat(r))}},{key:"$dispatch",value:function(t){this.store.dispatch(t)}},{key:"storeChanged",value:function(){}},{key:"isWatching",value:function(t){return this.subscribe.includes(t)}},{key:"$on",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=(e=this.emitter).subscribe.apply(e,[t].concat(r));this.unsubscribers.push(i)}},{key:"init",value:function(){this.initDOMListeners()}},{key:"destroy",value:function(){this.removeDOMListeners(),this.unsubscribers.forEach((function(t){return t()}))}}],n&&F(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(z);function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function V(){return V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=tt(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},V.apply(this,arguments)}function tt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rt(t)););return t}function et(t,e){return et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},et(t,e)}function nt(t,e){if(e&&("object"===Q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function rt(t){return rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rt(t)}function ot(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var it=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&et(t,e)}(c,t);var e,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=rt(r);if(o){var n=rt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return nt(this,t)});function c(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),i.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){ot(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Formula",listeners:["input","click","keydown"],subscribe:["currentText"]},e))}return e=c,(n=[{key:"toHTML",value:function(){return'\n            <div class="info">\n                fx\n            <div class="hint">=1+1</div>\n            </div>\n            <div \n            id="formula" \n            class="input" \n            contenteditable\n            spellcheck="false"\n            placeholder="1231"\n           ></div>\n        '}},{key:"init",value:function(){var t=this;V(rt(c.prototype),"init",this).call(this),this.$formula=this.$root.find("#formula"),this.$on("table:input",(function(e){t.$formula.text(e.data.value)}))}},{key:"onInput",value:function(t){var e=y(t.target).text();this.$emit("formula:input",e)}},{key:"onClick",value:function(t){}},{key:"storeChanged",value:function(t){var e=t.currentText;this.$formula.text(e)}},{key:"onKeydown",value:function(t){["Enter","Tab"].includes(t.key)&&(t.preventDefault(),this.$emit("formula:enter"))}}])&&Z(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(U);ot(it,"className","excel__formula");var ct={textAlign:"left",fontStyle:"normal",fontWeight:"normal",textDecoration:"none"},at="New Title";function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(n),!0).forEach((function(e){bt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pt(t,e){return pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pt(t,e)}function yt(t,e){if(e&&("object"===ut(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ht(t){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ht(t)}function bt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var vt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pt(t,e)}(l,t);var n,r,i,c,u=(i=l,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ht(i);if(c){var n=ht(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return yt(this,t)});function l(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),u.call(this,t,ft(ft({name:"Header"},e),{},{listeners:["input","click"]}))}return n=l,(r=[{key:"prepare",value:function(){this.onInput=a(this.onInput,300)}},{key:"onInput",value:function(t){var e,n=y(t.target);this.$dispatch((e=n.text(),{type:C,data:e}))}},{key:"onClick",value:function(t){var n=y(t.target);"remove"===n.data.button?confirm("are you sure you want to delete this table")&&(o().remove("excel:"+e.param),e.navigate("")):"exit"===n.data.button&&e.navigate("")}},{key:"toHTML",value:function(){var t=this.store.getState().title||at;return'\n      <input type="text" class="input" value="'.concat(t,'">\n\n      <div>\n        <div class="button" data-button="remove">\n          <span class="material-icons" data-button="remove">\n            delete\n          </span>\n        </div>\n\n        <div class="button" data-button="exit">\n          <span class="material-icons" data-button="exit">\n            exit_to_app\n          </span>\n        </div>\n    ')}}])&&st(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),l}(U);function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}bt(vt,"className","excel__header");var mt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.group=[],this.current=null}var e,n;return e=t,n=[{key:"select",value:function(e){this.clear(),this.group.push(e),e.focus().addClass(t.className),this.current=e}},{key:"clear",value:function(){this.group.forEach((function(e){return e.removeClass(t.className)})),this.group=[]}},{key:"selectGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.clear(),this.group=e,this.group.forEach((function(e){return e.addClass(t.className)}))}},{key:"selectedIds",get:function(){return this.group.map((function(t){return t.id()}))}},{key:"applyStyle",value:function(t){this.group.forEach((function(e){e.css(t)}))}}],n&&dt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(mt,"className","selected");var gt=__webpack_require__(201);function wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wt(Object(n),!0).forEach((function(e){jt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function jt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _t(t,e){return(t[e]||120)+"px"}function Pt(t,e){return function(n,r){var o="".concat(t,":").concat(r),i=e.dataState[o]||"",a=_t(e.colState,r),u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).map((function(e){return"".concat(c(e),":").concat(t[e])})).join(";")}(Ot(Ot({},ct),e.stylesState[o]));return'\n            <div \n                 class="cell" \n                 contenteditable \n                 data-col="'.concat(r,'"\n                 data-type="cell" \n                 data-id="').concat(t,":").concat(r,'"\n                 data-value="').concat(i,'" \n                 style="width:').concat(a,"; ").concat(u,'"\n                 >\n                 ').concat((0,gt.Q)(i),"\n            </div>")}}function St(t,e){return String.fromCodePoint(65+e)}function kt(t){var e=t.col,n=t.index,r=t.width;return'\n    <div class="column" data-type="resizable" data-col="'.concat(n,'" style="width:').concat(r,'">\n      ').concat(e,'\n      <div class="col-resize" data-resize="col">\n      </div>\n    </div>\n  ')}function Et(t,e,n){var r=function(t,e){return(t[e]||24)+"px"}(n,t),o=t?'<div class="row-resize" data-resize="row"></div>':"";return'\n    <div class="row"\n      data-type="resizable"\n      data-row="'.concat(t||0,'"\n      style="height:').concat(r,'"\n      >\n      <div class="row-info">\n        ').concat(t||"","\n        ").concat(o,'\n      </div>\n      <div class="row-data">').concat(e,"</div> \n    </div>\n")}function xt(t){return function(e,n){return{col:e,index:n,width:_t(t.colState,n)}}}function Tt(t,e){return new Promise((function(n){var r,o=e.closest('[data-type="resizable"]'),i=o.getCoords(),c=t.findAll('[data-col="'.concat(o.data.col,'"]')),a=e.data.resize,u="col"===a?"bottom":"right";e.css(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({opacity:1},u,"-50000px")),document.onmousemove=function(t){if("col"===a){var n=t.pageX-i.right;r=n+i.width,e.css({right:-n+"px"})}else{var o=t.pageY-i.bottom;r=o+i.height,e.css({bottom:-o+"px"})}},document.onmouseup=function(t){document.onmousemove=null,"col"===a?c.forEach((function(t){return t.css({width:r+"px"})})):o.css({height:r+"px"}),e.css({opacity:0,right:0,bottom:0}),n({type:a,value:r,id:o.data[a]})},document.ondblclick=function(t){"col"===t.target.dataset.resize?c.forEach((function(t){return t.css({width:"120px"})})):"row"===t.target.dataset.resize&&o.css({height:"24px"})}}))}function Dt(t){return"cell"===t.data.type}function Rt(t,e){var n=t.id(!0),o=e.id(!0),i=r(o.col,n.col),c=r(o.row,n.row);return i.reduce((function(t,e){return c.forEach((function(n){return t.push("".concat(n,":").concat(e))})),t}),[])}function $t(t,e){return event.shiftKey&&Dt(t)&&e}function Lt(t){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lt(t)}function Ct(){Ct=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function a(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof s?e:s,i=Object.create(o.prototype),c=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var c=n.delegate;if(c){var a=w(c,n);if(a){if(a===f)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,c),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var f={};function s(){}function p(){}function y(){}var h={};a(h,o,(function(){return this}));var b=Object.getPrototypeOf,v=b&&b(b(P([])));v&&v!==e&&n.call(v,o)&&(h=v);var d=y.prototype=s.prototype=Object.create(h);function m(t){["next","throw","return"].forEach((function(e){a(t,e,(function(t){return this._invoke(e,t)}))}))}function g(t,e){function r(o,i,c,a){var u=l(t[o],t,i);if("throw"!==u.type){var f=u.arg,s=f.value;return s&&"object"==Lt(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,c,a)}),(function(t){r("throw",t,c,a)})):e.resolve(s).then((function(t){f.value=t,c(f)}),(function(t){return r("throw",t,c,a)}))}a(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,f;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function P(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=y,a(d,"constructor",y),a(y,"constructor",p),p.displayName=a(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,a(t,c,"GeneratorFunction")),t.prototype=Object.create(d),t},t.awrap=function(t){return{__await:t}},m(g.prototype),a(g.prototype,i,(function(){return this})),t.AsyncIterator=g,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var c=new g(u(e,n,r,o),i);return t.isGeneratorFunction(n)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},m(d),a(d,c,"Generator"),a(d,o,(function(){return this})),a(d,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=P,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return c.type="throw",c.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=t,c.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(c)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:P(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function At(t,e,n,r,o,i,c){try{var a=t[i](c),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,o)}function Nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function It(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mt(){return Mt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Bt(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Mt.apply(this,arguments)}function Bt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gt(t)););return t}function Ht(t,e){return Ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ht(t,e)}function zt(t,e){if(e&&("object"===Lt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Gt(t){return Gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gt(t)}function qt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ht(t,e)}(u,t);var e,n,r,o,i,c,a=(i=u,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Gt(i);if(c){var n=Gt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return zt(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),n=a.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(n),!0).forEach((function(e){qt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Table",listeners:["mousedown","keydown","input","mousemove","mouseup"]},e)),n.isMouseDown=!1,n}return e=u,n=[{key:"prepare",value:function(){this.selection=new mt}},{key:"init",value:function(){var t=this;Mt(Gt(u.prototype),"init",this).call(this);var e=this.$root.find('[data-id="0:0"]');this.selectCell(e),this.$on("formula:input",(function(e){t.selection.current.attr("data-value",e).text((0,gt.Q)(e)),t.updateTextInStore(e)})),this.$on("toolbar:applyStyle",(function(e){var n;t.selection.applyStyle(e),t.$dispatch((n={value:e,ids:t.selection.selectedIds},{type:$,data:n}))})),this.$on("formula:enter",(function(){t.selectCell(e)}))}},{key:"selectCell",value:function(t){this.selection.select(t),this.$emit("table:input",t);var e=t.getStyles(Object.keys(ct));this.$dispatch({type:L,data:e})}},{key:"resizeTable",value:(r=Ct().mark((function t(e){var n;return Ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Tt(this.$root,e);case 3:n=t.sent,this.$dispatch(N(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.warn("Resize error",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})),o=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function c(t){At(i,n,o,c,a,"next",t)}function a(t){At(i,n,o,c,a,"throw",t)}c(void 0)}))},function(t){return o.apply(this,arguments)})},{key:"onMouseup",value:function(){this.isMouseDown=!1}},{key:"onMousemove",value:function(t){var e=this;if($t(y(t.target),this.isMouseDown)){var n=Rt(y(t.target),this.selection.current).map((function(t){return e.$root.find('[data-id="'.concat(t,'"]'))}));this.selection.selectGroup(n)}}},{key:"onMousedown",value:function(t){var e=this;this.isMouseDown=!0;var n=y(t.target);if(y)if(n.data.resize)this.resizeTable(n);else if(Dt(n))if(t.shiftKey){var r=Rt(n,this.selection.current).map((function(t){return e.$root.find('[data-id="'.concat(t,'"]'))}));this.selection.selectGroup(r)}else this.selectCell(n)}},{key:"updateTextInStore",value:function(t){var e;this.$dispatch((e={id:this.selection.current.id(),value:t},{type:R,data:e}))}},{key:"onInput",value:function(t){this.updateTextInStore(y(t.target).text())}},{key:"toHTML",value:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,e=arguments.length>1?arguments[1]:void 0,n=26,r=[],o=new Array(n).fill("").map(St).map(xt(e)).map(kt).join("");r.push(Et(null,o,{}));for(var i=0;i<t;i++){var c=new Array(n).fill("").map(Pt(i,e)).join("");r.push(Et(i+1,c,e.rowState))}return r.join("")}(10,this.store.getState())}},{key:"onKeydown",value:function(t){var e=t.key;if(["ArrowLeft","ArrowRight","ArrowDown","ArrowUp","Enter","Tab"].includes(e)&&!t.shiftKey){t.preventDefault();var n=this.selection.current.id(!0),r=this.$root.find(function(t,e,n){var r=n.row,o=n.col,i=t.$el.children.length-2,c=t.$el.children[0].querySelector(".row-data").children.length-1;switch(e){case"Enter":case"ArrowDown":r=r+1>i?i:r+1;break;case"Tab":case"ArrowRight":o=o+1>c?c:o+1;break;case"ArrowLeft":o=o-1<0?0:o-1;break;case"ArrowUp":r=r-1<0?0:r-1}return'[data-id="'.concat(r,":").concat(o,'"]')}(this.$root,e,n));this.selectCell(r)}}}],n&&It(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(U);function Ft(t){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ft(t)}function Wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wt(Object(n),!0).forEach((function(e){Kt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Kt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xt(t,e){return Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xt(t,e)}function Zt(t,e){if(e&&("object"===Ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Vt(t){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vt(t)}qt(Jt,"className","excel__table");var te=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xt(t,e)}(c,t);var e,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Vt(r);if(o){var n=Vt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Zt(this,t)});function c(){Ut(this,c);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.call.apply(i,[this].concat(e))}return e=c,n=[{key:"template",get:function(){return JSON.stringify(this.state,null,2)}},{key:"initState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=Yt({},t)}},{key:"setState",value:function(t){this.state=Yt(Yt({},this.state),t),this.$root.html(this.template)}}],n&&Qt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(U);function ee(t){var e=t.icon,n=t.active,r=t.value,o=JSON.stringify(r),i='data-type="button" data-value=\''.concat(o,"'");return'\n     <div class="button '.concat(n?"active":"",'" ').concat(i,'>\n       <span class="material-icons" ').concat(i,">\n          ").concat(e,"\n       </span>\n     </div>\n  ")}function ne(t){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ne(t)}function re(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ie(t,e){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ie(t,e)}function ce(t,e){if(e&&("object"===ne(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ae(t){return ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ae(t)}function ue(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var le=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ie(t,e)}(a,t);var e,n,r,o,c=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ae(r);if(o){var n=ae(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return ce(this,t)});function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),c.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?re(Object(n),!0).forEach((function(e){ue(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Toolbar",listeners:["click"],subscribe:["currentStyles"]},e))}return e=a,n=[{key:"onClick",value:function(t){var e=y(t.target);if("button"===e.data.type){var n=JSON.parse(e.data.value);this.$emit("toolbar:applyStyle",n),this.setState(n)}}},{key:"storeChanged",value:function(t){this.setState(t.currentStyles)}},{key:"prepare",value:function(){this.initState(ct)}},{key:"template",get:function(){return[{icon:"format_align_left",active:i((t=this.state).textAlign,"left"),value:{textAlign:"left"}},{icon:"format_align_center",active:i(t.textAlign,"center"),value:{textAlign:"center"}},{icon:"format_align_right",active:i(t.textAlign,"right"),value:{textAlign:"right"}},{icon:"format_bold",active:i(t.fontWeight,"bold"),value:{fontWeight:"bold"===t.fontWeight?"normal":"bold"}},{icon:"format_italic",active:i(t.fontStyle,"italic"),value:{fontStyle:"italic"===t.fontStyle?"normal":"italic"}},{icon:"format_underline",active:i(t.textDecoration,"underline"),value:{textDecoration:"underline"===t.textDecoration?"none":"underline"}}].map(ee).join("");var t}},{key:"toHTML",value:function(){return this.template}}],n&&oe(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(te);function fe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function se(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fe(Object(n),!0).forEach((function(e){pe(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function pe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ye(t,e){var n,r,o;switch(e.type){case D:return r="col"===e.data.type?"colState":"rowState",se(se({},t),{},pe({},r,he(t,r,e)));case R:return r="dataState",se(se({},t),{},pe({currentText:e.data.value},r,he(t,r,e)));case L:return se(se({},t),{},{currentStyles:e.data});case $:return o=t[r="stylesState"]||{},e.data.ids.forEach((function(t){o[t]=se(se({},o[t]),e.data.value)})),se(se({},t),{},(pe(n={},r,o),pe(n,"currentStyles",se(se({},t.currentStyles),e.value)),n));case C:return se(se({},t),{},{title:e.data});case A:return se(se({},t),{},{openedDate:(new Date).toJSON()});default:return t}}function he(t,e,n){var r=t[e]||{};return r[n.data.id]=n.data.value,r}function be(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ve(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?be(Object(n),!0).forEach((function(e){de(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function de(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}ue(le,"className","excel__toolbar");var me={title:at,colState:{},rowState:{},dataState:{},stylesState:{},currentText:"",currentStyles:ct,openedDate:(new Date).toJSON()};function ge(t){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(t)}function we(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function je(t,e){return je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},je(t,e)}function _e(t,e){if(e&&("object"===ge(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Pe(t){return Pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pe(t)}function Se(t){return"excel:"+t}var ke=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&je(t,e)}(l,t);var e,n,r,i,c=(r=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Pe(r);if(i){var n=Pe(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return _e(this,t)});function l(){return we(this,l),c.apply(this,arguments)}return e=l,n=[{key:"getRoot",value:function(){var t,e=this,n=function(t){var e=t(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{type:"__INIT__"}),n=[];return{subscribe:function(t){return n.push(t),{unsubscribe:function(){n=n.filter((function(e){return e!==t}))}}},dispatch:function(r){e=t(e,r),n.forEach((function(t){return t(e)}))},getState:function(){return u(e)}}}(ye,(t=o(Se(this.params)).get())?function(t){return ve(ve({},t),{},{currentStyles:ct,currentText:""})}(t):u(me)),r=a((function(t){o(Se(e.params)).set(t)}),300);return n.subscribe(r),this.excel=new M({components:[vt,le,it,Jt],store:n}),y(this.excel.getRoot())}},{key:"afterRender",value:function(){this.excel.init()}},{key:"destroy",value:function(){this.excel.destroy()}}],n&&Oe(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),l}(d);window.r=new b("#app",{dashboard:S,excel:ke})}()})();